axis(1, at=seq(1960,2050,10),las=1)
title(ylab="Life Expectancy at Age 20",xlab=expression(paste("(b) ",LE[t],sep="")),cex.lab=0.85)
# place legend in order of constellations of counterfactuals
legend(x= "topleft",inset=0,cex=0.5,
legend = c("Data","Predicted",
expression(paste("No Demand Effects")),
expression(paste("No Markups")),
expression(paste("No Technical Change")) #,
#expression(paste(mu,"=1",sep="")),
#expression(paste(g[c],"=",g[h],"=0")),
#expression(paste(g[z],"=",g[zeta],"=",g[n],"=0")) #,
# expression(paste(g[c],"=",g[h],"=0",",",mu,"=1")),
# expression(paste(g[c],"=",g[h],"=",g[z],"=",g[zeta],"=",g[n],"=0")),
# expression(paste(g[c],",",g[h],"=0")),
# expression(paste(g[c],",",g[h],",",g[z],"=0")),
# expression(paste(g[c],"=0")),
# expression(paste(g[h],"=0")),
# expression(paste(g[z],"=0")),
# expression(paste(g[n],"=0")),
# expression(paste(g[zeta],"=0")),
# expression(paste(g[z],",",g[zeta],"=0")),
),
pch = c(17,1,5:7),
#  pch = c(17,1,rep(NA,3)),
lty=c(1,3,rep(1,3)),
col = c("black","black",cols),
lwd=1)
#  dev.off()
### figure 7c ###
# no's (1:3)
ymin = min(he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
ymax = max(he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
#he_counters_normalized$year = seq(1950,2050,5)
cols = c("blue","red","purple") #,"darkgreen","darkorange","gold2") #"goldenrod4","darkseagreen","cornflowerblue","darkcyan","darksalmon","gold2")
#  png(filename=paste(results_dir,"/figure7c.png",sep=""),width=5,height=4,units="in",res=600)
#  par(mar = c(2,5,2,2))
with(he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),],plot(year,V1,type="n",ann=FALSE,ylim=c(ymin,ymax),ylab=NA,xlab=NA,xaxt="n"))
grid()
for(i in 1:3){
lines(he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),"year"],he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),i],col=cols[i],lty=1,lwd=1)
points(he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),"year"],he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),i],col=cols[i],pch=4+i,lwd=1.2)
}
with(he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),],points(year,data,pch=17,col="black",lwd=4))
with(he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),],points(year,predicted,pch=1,col="black",lwd=2))
with(he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),],lines(year,data,col="black",lwd=1,lty=1))
with(he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),],lines(year,predicted,col="black",lwd=1,lty=3))
axis(1, at=seq(1960,2050,10),las=1)
title(ylab="Health Share of Aggregate Expenditure",xlab=expression(paste("(c) ",p[t],H[t],"/(",p[t],H[t],"+",C[t],")",sep="")),cex.lab=0.85)
# place legend in order of constellations of counterfactuals
legend(x= "topleft",inset=0,cex=0.5,
legend = c("Data","Predicted",
expression(paste("No Demand Effects")),
expression(paste("No Markups")),
expression(paste("No Technical Change")) #,
#expression(paste(mu,"=1",sep="")),
#expression(paste(g[c],"=",g[h],"=0")),
#expression(paste(g[z],"=",g[zeta],"=",g[n],"=0")) #,
# expression(paste(g[c],"=",g[h],"=0",",",mu,"=1")),
# expression(paste(g[c],"=",g[h],"=",g[z],"=",g[zeta],"=",g[n],"=0")),
# expression(paste(g[c],",",g[h],"=0")),
# expression(paste(g[c],",",g[h],",",g[z],"=0")),
# expression(paste(g[c],"=0")),
# expression(paste(g[h],"=0")),
# expression(paste(g[z],"=0")),
# expression(paste(g[n],"=0")),
# expression(paste(g[zeta],"=0")),
# expression(paste(g[z],",",g[zeta],"=0")),
),
pch = c(17,1,5:7),
#  pch = c(17,1,rep(NA,3)),
lty=c(1,3,rep(1,3)),
col = c("black","black",cols),
lwd=1)
#dev.off()
#### figure 7d ####
# no's (1:3)
ymin = min(k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
ymax = max(k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
#k_share_normalized$year = seq(1950,2050,5)
cols = c("blue","red","purple") #,"darkgreen","darkorange","gold2") #"goldenrod4","darkseagreen","cornflowerblue","darkcyan","darksalmon","gold2")
# png(filename=paste(results_dir,"/figure7d.png",sep=""),width=5,height=4,units="in",res=600)
# par(mar = c(2,5,2,2))
with(k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),],plot(year,V1,type="n",ann=FALSE,ylim=c(ymin,ymax),ylab=NA,xlab=NA,xaxt="n"))
grid()
for(i in 1:3){
lines(k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),"year"],k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),i],col=cols[i],lty=1,lwd=1)
points(k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),"year"],k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),i],col=cols[i],pch=4+i,lwd=1.2)
}
with(k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),],points(year,data,pch=17,col="black",lwd=4))
with(k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),],points(year,predicted,pch=1,col="black",lwd=2))
with(k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),],lines(year,data,col="black",lwd=1,lty=1))
with(k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),],lines(year,predicted,col="black",lwd=1,lty=3))
axis(1, at=seq(1960,2050,10),las=1)
title(ylab="Health Production Share of Capital",xlab=expression(paste("(d) ",K[ht],"/",K[t],sep="")),cex.lab=0.85)
# place legend in order of constellations of counterfactuals
legend(x= "topleft",inset=0,cex=0.5,
legend = c("Data","Predicted",
expression(paste("No Demand Effects")),
expression(paste("No Markups")),
expression(paste("No Technical Change")) #,
#expression(paste(mu,"=1",sep="")),
#expression(paste(g[c],"=",g[h],"=0")),
#expression(paste(g[z],"=",g[zeta],"=",g[n],"=0")) #,
# expression(paste(g[c],"=",g[h],"=0",",",mu,"=1")),
# expression(paste(g[c],"=",g[h],"=",g[z],"=",g[zeta],"=",g[n],"=0")),
# expression(paste(g[c],",",g[h],"=0")),
# expression(paste(g[c],",",g[h],",",g[z],"=0")),
# expression(paste(g[c],"=0")),
# expression(paste(g[h],"=0")),
# expression(paste(g[z],"=0")),
# expression(paste(g[n],"=0")),
# expression(paste(g[zeta],"=0")),
# expression(paste(g[z],",",g[zeta],"=0")),
),
pch = c(17,1,5:7),
#  pch = c(17,1,rep(NA,3)),
lty=c(1,3,rep(1,3)),
col = c("black","black",cols),
lwd=1)
# dev.off()
### FIGURE 7E ###
# no's (1:3)
ymin = min(l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
ymax = max(l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
#l_share_normalized$year = seq(1950,2050,5)
cols = c("blue","red","purple") #,"darkgreen","darkorange","gold2") #"goldenrod4","darkseagreen","cornflowerblue","darkcyan","darksalmon","gold2")
# png(filename=paste(results_dir,"/figure7e.png",sep=""),width=5,height=4,units="in",res=600)
# par(mar = c(2,5,2,2))
with(l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),],plot(year,V1,type="n",ann=FALSE,ylim=c(ymin,ymax),ylab=NA,xlab=NA,xaxt="n"))
grid()
for(i in 1:3){
lines(l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),"year"],l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),i],col=cols[i],lty=1,lwd=1)
points(l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),"year"],l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),i],col=cols[i],pch=4+i,lwd=1.2)
}
with(l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),],points(year,data,pch=17,col="black",lwd=4))
with(l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),],points(year,predicted,pch=1,col="black",lwd=2))
with(l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),],lines(year,data,col="black",lwd=1,lty=1))
with(l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),],lines(year,predicted,col="black",lwd=1,lty=3))
axis(1, at=seq(1960,2050,10),las=1)
title(ylab="Health Production Share of Labor",xlab=expression(paste("(e) ",L[ht],"/",L[t],sep="")),cex.lab=0.85)
# place legend in order of constellations of counterfactuals
legend(x= "topleft",inset=0,cex=0.5,
legend = c("Data","Predicted",
expression(paste("No Demand Effects")),
expression(paste("No Markups")),
expression(paste("No Technical Change")) #,
#expression(paste(mu,"=1",sep="")),
#expression(paste(g[c],"=",g[h],"=0")),
#expression(paste(g[z],"=",g[zeta],"=",g[n],"=0")) #,
# expression(paste(g[c],"=",g[h],"=0",",",mu,"=1")),
# expression(paste(g[c],"=",g[h],"=",g[z],"=",g[zeta],"=",g[n],"=0")),
# expression(paste(g[c],",",g[h],"=0")),
# expression(paste(g[c],",",g[h],",",g[z],"=0")),
# expression(paste(g[c],"=0")),
# expression(paste(g[h],"=0")),
# expression(paste(g[z],"=0")),
# expression(paste(g[n],"=0")),
# expression(paste(g[zeta],"=0")),
# expression(paste(g[z],",",g[zeta],"=0")),
),
pch = c(17,1,5:7),
#  pch = c(17,1,rep(NA,3)),
lty=c(1,3,rep(1,3)),
col = c("black","black",cols),
lwd=1)
# dev.off()
#### figure 7f ####
# no's (1:3)
ymin = min(gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
ymax = max(gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
#gy_counters_normalized$year = seq(1950,2050,5)
cols = c("blue","red","purple") #,"darkgreen","darkorange","gold2") #"goldenrod4","darkseagreen","cornflowerblue","darkcyan","darksalmon","gold2")
#  png(filename=paste(results_dir,"/figure7f.png",sep=""),width=5,height=4,units="in",res=600)
#  par(mar = c(2,5,2,2))
with(gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),],plot(year,V1,type="n",ann=FALSE,ylim=c(ymin,ymax),ylab=NA,xlab=NA,xaxt="n"))
grid()
for(i in 1:3){
lines(gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),"year"],gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),i],col=cols[i],lty=1,lwd=2)
points(gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),"year"],gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),i],col=cols[i],pch=4+i,lwd=1.2)
}
with(gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),],points(year,data,pch=17,col="black",lwd=4))
with(gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),],points(year,predicted,pch=1,col="black",lwd=2))
with(gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),],lines(year,data,col="black",lwd=1,lty=1))
with(gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),],lines(year,predicted,col="black",lwd=1,lty=3))
axis(1, at=seq(1960,2050,10),las=1)
title(ylab="Average Annual GDP Growth Rate",xlab=expression(paste("(f) ",g[Yt],sep="")),cex.lab=0.85)
# place legend in order of constellations of counterfactuals
legend(x= "bottomleft",inset=0,cex=0.5,
legend = c("Data","Predicted",
expression(paste("No Demand Effects")),
expression(paste("No Markups")),
expression(paste("No Technical Change")) #,
#expression(paste(mu,"=1",sep="")),
#expression(paste(g[c],"=",g[h],"=0")),
#expression(paste(g[z],"=",g[zeta],"=",g[n],"=0")) #,
# expression(paste(g[c],"=",g[h],"=0",",",mu,"=1")),
# expression(paste(g[c],"=",g[h],"=",g[z],"=",g[zeta],"=",g[n],"=0")),
# expression(paste(g[c],",",g[h],"=0")),
# expression(paste(g[c],",",g[h],",",g[z],"=0")),
# expression(paste(g[c],"=0")),
# expression(paste(g[h],"=0")),
# expression(paste(g[z],"=0")),
# expression(paste(g[n],"=0")),
# expression(paste(g[zeta],"=0")),
# expression(paste(g[z],",",g[zeta],"=0")),
),
pch = c(17,1,5:7),
#  pch = c(17,1,rep(NA,3)),
lty=c(1,3,rep(1,3)),
col = c("black","black",cols),
lwd=1)
dev.off()
############################### FIGURE 8 #######################################
# Open a PNG device (optional)
png(paste0(results_dir,"/figure8.png"), width = 2500, height = 1700, res = 300)
# Define a 2x2 layout with custom widths and heights
layout_matrix <- matrix(c(1, 2, 3, 4, 5, 6), nrow = 2, byrow = TRUE)
# Set up the layout with different relative sizes
layout(layout_matrix, widths = c(1, 1), heights = c(1, 1, 1))
# Add borders to visualize plot boundaries
par(mar = c(4, 4.3, 2, 1))  # margin setup
#### figure 8a ####
# yay's (4:6)
ymin = min(p_counters_normalized[p_counters_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
ymax = max(p_counters_normalized[p_counters_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
#p_counters_normalized$year = seq(1950,2050,5)
cols = c("darkorange","darkcyan","goldenrod4") #"goldenrod4","darkseagreen","cornflowerblue","darkcyan","darksalmon","gold2")
#png(filename=paste(results_dir,"/figure8a.png",sep=""),width=5,height=4,units="in",res=600)
#par(mar = c(2,5,2,2))
with(p_counters_normalized[p_counters_normalized$year %in% seq(1960,2050,5),],plot(year,V4,type="n",ann=FALSE,ylim=c(ymin,ymax),ylab=NA,xlab=NA,xaxt="n"))
grid()
for(i in 1:3){
lines(p_counters_normalized[p_counters_normalized$year %in% seq(1960,2050,5),"year"],p_counters_normalized[p_counters_normalized$year %in% seq(1960,2050,5),i+3],col=cols[i],lty=1,lwd=1)
points(p_counters_normalized[p_counters_normalized$year %in% seq(1960,2050,5),"year"],p_counters_normalized[p_counters_normalized$year %in% seq(1960,2050,5),i+3],col=cols[i],pch=4+i,lwd=1.2)
}
with(p_counters_normalized[p_counters_normalized$year %in% seq(1960,2050,5),],points(year,data,pch=17,col="black",lwd=4))
with(p_counters_normalized[p_counters_normalized$year %in% seq(1960,2050,5),],points(year,predicted,pch=1,col="black",lwd=2))
with(p_counters_normalized[p_counters_normalized$year %in% seq(1960,2050,5),],lines(year,data,col="black",lwd=1,lty=1))
with(p_counters_normalized[p_counters_normalized$year %in% seq(1960,2050,5),],lines(year,predicted,col="black",lwd=1,lty=3))
axis(1, at=seq(1960,2050,10),las=1)
title(ylab="Relative Price of Health Care",xlab=expression(paste("(a) ",p[t],sep="")),cex.lab=0.85)
# place legend in order of constellations of counterfactuals
legend(x= "topleft",inset=0,cex=0.5,
legend = c("Data","Predicted",
expression(paste("Only Demand Effects")),
expression(paste("Only Markups")),
expression(paste("Only Technical Change"))
#   expression(paste(mu,"=1",sep="")),
#   expression(paste(g[c],"=",g[h],"=0")),
#   expression(paste(g[z],"=",g[zeta],"=",g[n],"=0")) #,
# expression(paste(g[c],"=",g[h],"=0",",",mu,"=1")),
# expression(paste(g[c],"=",g[h],"=",g[z],"=",g[zeta],"=",g[n],"=0")),
# expression(paste(g[z],"=",g[zeta],"=",g[n],"=0",",",mu,"=1"))
# expression(paste(g[c],",",g[h],"=0")),
# expression(paste(g[c],",",g[h],",",g[z],"=0")),
# expression(paste(g[c],"=0")),
# expression(paste(g[h],"=0")),
# expression(paste(g[z],"=0")),
# expression(paste(g[n],"=0")),
# expression(paste(g[zeta],"=0")),
# expression(paste(g[z],",",g[zeta],"=0")),
),
pch = c(17,1,5:7),
#  pch = c(17,1,rep(NA,3)),
lty=c(1,3,rep(1,3)),
col = c("black","black",cols),
lwd=1)
#dev.off()
#### figure 8b ####
# yay's (4:6)
ymin = min(le_counters_normalized[le_counters_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
ymax = max(le_counters_normalized[le_counters_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
#le_counters_normalized$year = seq(1950,2050,5)
cols = c("darkorange","darkcyan","goldenrod4") #"goldenrod4","darkseagreen","cornflowerblue","darkcyan","darksalmon","gold2")
#png(filename=paste(results_dir,"/figure8b.png",sep=""),width=5,height=4,units="in",res=600)
#par(mar = c(2,5,2,2))
with(le_counters_normalized[le_counters_normalized$year %in% seq(1960,2050,5),],plot(year,V4,type="n",ann=FALSE,ylim=c(ymin,ymax),ylab=NA,xlab=NA,xaxt="n"))
grid()
for(i in 1:3){
lines(le_counters_normalized[le_counters_normalized$year %in% seq(1960,2050,5),"year"],le_counters_normalized[le_counters_normalized$year %in% seq(1960,2050,5),i+3],col=cols[i],lty=1,lwd=1)
points(le_counters_normalized[le_counters_normalized$year %in% seq(1960,2050,5),"year"],le_counters_normalized[le_counters_normalized$year %in% seq(1960,2050,5),i+3],col=cols[i],pch=4+i,lwd=1.2)
}
with(le_counters_normalized[le_counters_normalized$year %in% seq(1960,2050,5),],points(year,data,pch=17,col="black",lwd=4))
with(le_counters_normalized[le_counters_normalized$year %in% seq(1960,2050,5),],points(year,predicted,pch=1,col="black",lwd=2))
with(le_counters_normalized[le_counters_normalized$year %in% seq(1960,2050,5),],lines(year,data,col="black",lwd=1,lty=1))
with(le_counters_normalized[le_counters_normalized$year %in% seq(1960,2050,5),],lines(year,predicted,col="black",lwd=1,lty=3))
axis(1, at=seq(1960,2050,10),las=1)
title(ylab="Life Expectancy at Age 20",xlab=expression(paste("(b) ",LE[t],sep="")),cex.lab=0.85)
# place legend in order of constellations of counterfactuals
legend(x= "topleft",inset=0,cex=0.5,
legend = c("Data","Predicted",
expression(paste("Only Demand Effects")),
expression(paste("Only Markups")),
expression(paste("Only Technical Change"))
#   expression(paste(mu,"=1",sep="")),
#   expression(paste(g[c],"=",g[h],"=0")),
#   expression(paste(g[z],"=",g[zeta],"=",g[n],"=0")) #,
# expression(paste(g[c],"=",g[h],"=0",",",mu,"=1")),
# expression(paste(g[c],"=",g[h],"=",g[z],"=",g[zeta],"=",g[n],"=0")),
# expression(paste(g[z],"=",g[zeta],"=",g[n],"=0",",",mu,"=1"))
# expression(paste(g[c],",",g[h],"=0")),
# expression(paste(g[c],",",g[h],",",g[z],"=0")),
# expression(paste(g[c],"=0")),
# expression(paste(g[h],"=0")),
# expression(paste(g[z],"=0")),
# expression(paste(g[n],"=0")),
# expression(paste(g[zeta],"=0")),
# expression(paste(g[z],",",g[zeta],"=0")),
),
pch = c(17,1,5:7),
#  pch = c(17,1,rep(NA,3)),
lty=c(1,3,rep(1,3)),
col = c("black","black",cols),
lwd=1)
#dev.off()
#### figure 8c ####
# yay's (4:6)
ymin = min(he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
ymax = max(he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
#he_counters_normalized$year = seq(1950,2050,5)
cols = c("darkorange","darkcyan","goldenrod4") #"goldenrod4","darkseagreen","cornflowerblue","darkcyan","darksalmon","gold2")
#png(filename=paste(results_dir,"/figure8c.png",sep=""),width=5,height=4,units="in",res=600)
#par(mar = c(2,5,2,2))
with(he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),],plot(year,V4,type="n",ann=FALSE,ylim=c(ymin,ymax),ylab=NA,xlab=NA,xaxt="n"))
grid()
for(i in 1:3){
lines(he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),"year"],he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),i+3],col=cols[i],lty=1,lwd=1)
points(he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),"year"],he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),i+3],col=cols[i],pch=4+i,lwd=1.2)
}
with(he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),],points(year,data,pch=17,col="black",lwd=4))
with(he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),],points(year,predicted,pch=1,col="black",lwd=2))
with(he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),],lines(year,data,col="black",lwd=1,lty=1))
with(he_counters_normalized[he_counters_normalized$year %in% seq(1960,2050,5),],lines(year,predicted,col="black",lwd=1,lty=3))
axis(1, at=seq(1960,2050,10),las=1)
title(ylab="Health Share of Aggregate Expenditure",xlab=expression(paste("(c) ",p[t],H[t],"/(",p[t],H[t],"+",C[t],")",sep="")),cex.lab=0.85)
# place legend in order of constellations of counterfactuals
legend(x= "topleft",inset=0,cex=0.5,
legend = c("Data","Predicted",
expression(paste("Only Demand Effects")),
expression(paste("Only Markups")),
expression(paste("Only Technical Change"))
#   expression(paste(mu,"=1",sep="")),
#   expression(paste(g[c],"=",g[h],"=0")),
#   expression(paste(g[z],"=",g[zeta],"=",g[n],"=0")) #,
# expression(paste(g[c],"=",g[h],"=0",",",mu,"=1")),
# expression(paste(g[c],"=",g[h],"=",g[z],"=",g[zeta],"=",g[n],"=0")),
# expression(paste(g[z],"=",g[zeta],"=",g[n],"=0",",",mu,"=1"))
# expression(paste(g[c],",",g[h],"=0")),
# expression(paste(g[c],",",g[h],",",g[z],"=0")),
# expression(paste(g[c],"=0")),
# expression(paste(g[h],"=0")),
# expression(paste(g[z],"=0")),
# expression(paste(g[n],"=0")),
# expression(paste(g[zeta],"=0")),
# expression(paste(g[z],",",g[zeta],"=0")),
),
pch = c(17,1,5:7),
#  pch = c(17,1,rep(NA,3)),
lty=c(1,3,rep(1,3)),
col = c("black","black",cols),
lwd=1)
#dev.off()
#### Figure 8d ####
# yay's (4:6)
ymin = min(k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
ymax = max(k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
#k_share_normalized$year = seq(1950,2050,5)
cols = c("darkorange","darkcyan","goldenrod4") #"goldenrod4","darkseagreen","cornflowerblue","darkcyan","darksalmon","gold2")
#png(filename=paste(results_dir,"/figure8d.png",sep=""),width=5,height=4,units="in",res=600)
#par(mar = c(2,5,2,2))
with(k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),],plot(year,V4,type="n",ann=FALSE,ylim=c(ymin,ymax),ylab=NA,xlab=NA,xaxt="n"))
grid()
for(i in 1:3){
lines(k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),"year"],k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),i+3],col=cols[i],lty=1,lwd=1)
points(k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),"year"],k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),i+3],col=cols[i],pch=4+i,lwd=1.2)
}
with(k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),],points(year,data,pch=17,col="black",lwd=4))
with(k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),],points(year,predicted,pch=1,col="black",lwd=2))
with(k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),],lines(year,data,col="black",lwd=1,lty=1))
with(k_share_normalized[k_share_normalized$year %in% seq(1960,2050,5),],lines(year,predicted,col="black",lwd=1,lty=3))
axis(1, at=seq(1960,2050,10),las=1)
title(ylab="Health Production Share of Capital",xlab=expression(paste("(d) ",K[ht],"/",K[t],sep="")),cex.lab=0.85)
# place legend in order of constellations of counterfactuals
legend(x= "topleft",inset=0,cex=0.5,
legend = c("Data","Predicted",
expression(paste("Only Demand Effects")),
expression(paste("Only Markups")),
expression(paste("Only Technical Change"))
#   expression(paste(mu,"=1",sep="")),
#   expression(paste(g[c],"=",g[h],"=0")),
#   expression(paste(g[z],"=",g[zeta],"=",g[n],"=0")) #,
# expression(paste(g[c],"=",g[h],"=0",",",mu,"=1")),
# expression(paste(g[c],"=",g[h],"=",g[z],"=",g[zeta],"=",g[n],"=0")),
# expression(paste(g[z],"=",g[zeta],"=",g[n],"=0",",",mu,"=1"))
# expression(paste(g[c],",",g[h],"=0")),
# expression(paste(g[c],",",g[h],",",g[z],"=0")),
# expression(paste(g[c],"=0")),
# expression(paste(g[h],"=0")),
# expression(paste(g[z],"=0")),
# expression(paste(g[n],"=0")),
# expression(paste(g[zeta],"=0")),
# expression(paste(g[z],",",g[zeta],"=0")),
),
pch = c(17,1,5:7),
#  pch = c(17,1,rep(NA,3)),
lty=c(1,3,rep(1,3)),
col = c("black","black",cols),
lwd=1)
#dev.off()
#### Figure 8e ####
# yay's (4:6)
ymin = min(l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
ymax = max(l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
#l_share_normalized$year = seq(1950,2050,5)
cols = c("darkorange","darkcyan","goldenrod4") #"goldenrod4","darkseagreen","cornflowerblue","darkcyan","darksalmon","gold2")
#png(filename=paste(results_dir,"/figure8e.png",sep=""),width=5,height=4,units="in",res=600)
#par(mar = c(2,5,2,2))
with(l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),],plot(year,V4,type="n",ann=FALSE,ylim=c(ymin,ymax),ylab=NA,xlab=NA,xaxt="n"))
grid()
for(i in 1:3){
lines(l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),"year"],l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),i+3],col=cols[i],lty=1,lwd=1)
points(l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),"year"],l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),i+3],col=cols[i],pch=4+i,lwd=1.2)
}
with(l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),],points(year,data,pch=17,col="black",lwd=4))
with(l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),],points(year,predicted,pch=1,col="black",lwd=2))
with(l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),],lines(year,data,col="black",lwd=1,lty=1))
with(l_share_normalized[l_share_normalized$year %in% seq(1960,2050,5),],lines(year,predicted,col="black",lwd=1,lty=3))
axis(1, at=seq(1960,2050,10),las=1)
title(ylab="Health Production Share of Labor",xlab=expression(paste("(e) ",L[ht],"/",L[t],sep="")),cex.lab=0.85)
# place legend in order of constellations of counterfactuals
legend(x= "topleft",inset=0,cex=0.5,
legend = c("Data","Predicted",
expression(paste("Only Demand Effects")),
expression(paste("Only Markups")),
expression(paste("Only Technical Change"))
#   expression(paste(mu,"=1",sep="")),
#   expression(paste(g[c],"=",g[h],"=0")),
#   expression(paste(g[z],"=",g[zeta],"=",g[n],"=0")) #,
# expression(paste(g[c],"=",g[h],"=0",",",mu,"=1")),
# expression(paste(g[c],"=",g[h],"=",g[z],"=",g[zeta],"=",g[n],"=0")),
# expression(paste(g[z],"=",g[zeta],"=",g[n],"=0",",",mu,"=1"))
# expression(paste(g[c],",",g[h],"=0")),
# expression(paste(g[c],",",g[h],",",g[z],"=0")),
# expression(paste(g[c],"=0")),
# expression(paste(g[h],"=0")),
# expression(paste(g[z],"=0")),
# expression(paste(g[n],"=0")),
# expression(paste(g[zeta],"=0")),
# expression(paste(g[z],",",g[zeta],"=0")),
),
pch = c(17,1,5:7),
#  pch = c(17,1,rep(NA,3)),
lty=c(1,3,rep(1,3)),
col = c("black","black",cols),
lwd=1)
#dev.off()
#### Figure 8f ####
# yay's (4:6)
ymin = min(gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
ymax = max(gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),c(1:8)],na.rm=TRUE)
#gy_counters_normalized$year = seq(1950,2050,5)
cols = c("darkorange","darkcyan","goldenrod4") #"goldenrod4","darkseagreen","cornflowerblue","darkcyan","darksalmon","gold2")
#png(filename=paste(results_dir,"/figure8f.png",sep=""),width=5,height=4,units="in",res=600)
#par(mar = c(2,5,2,2))
with(gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),],plot(year,V4,type="n",ann=FALSE,ylim=c(ymin,ymax),ylab=NA,xlab=NA,xaxt="n"))
grid()
for(i in 1:3){
lines(gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),"year"],gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),i+3],col=cols[i],lty=1,lwd=2)
points(gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),"year"],gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),i+3],col=cols[i],pch=4+i,lwd=1.2)
}
with(gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),],points(year,data,pch=17,col="black",lwd=4))
with(gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),],points(year,predicted,pch=1,col="black",lwd=2))
with(gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),],lines(year,data,col="black",lwd=1,lty=1))
with(gy_counters_normalized[gy_counters_normalized$year %in% seq(1960,2050,5),],lines(year,predicted,col="black",lwd=1,lty=3))
axis(1, at=seq(1960,2050,10),las=1)
title(ylab="Average Annual GDP Growth Rate",xlab=expression(paste("(f) ",g[Yt],sep="")),cex.lab=0.85)
# place legend in order of constellations of counterfactuals
legend(x= "topright",inset=0,cex=0.5,
legend = c("Data","Predicted",
expression(paste("Only Demand Effects")),
expression(paste("Only Markups")),
expression(paste("Only Technical Change"))
#   expression(paste(mu,"=1",sep="")),
#   expression(paste(g[c],"=",g[h],"=0")),
#   expression(paste(g[z],"=",g[zeta],"=",g[n],"=0")) #,
# expression(paste(g[c],"=",g[h],"=0",",",mu,"=1")),
# expression(paste(g[c],"=",g[h],"=",g[z],"=",g[zeta],"=",g[n],"=0")),
# expression(paste(g[z],"=",g[zeta],"=",g[n],"=0",",",mu,"=1"))
# expression(paste(g[c],",",g[h],"=0")),
# expression(paste(g[c],",",g[h],",",g[z],"=0")),
# expression(paste(g[c],"=0")),
# expression(paste(g[h],"=0")),
# expression(paste(g[z],"=0")),
# expression(paste(g[n],"=0")),
# expression(paste(g[zeta],"=0")),
# expression(paste(g[z],",",g[zeta],"=0")),
),
pch = c(17,1,5:7),
#  pch = c(17,1,rep(NA,3)),
lty=c(1,3,rep(1,3)),
col = c("black","black",cols),
lwd=1)
dev.off()
print("#########################################################################")
print("#########################################################################")
print("#########################################################################")
print("###### END Calibration R script for GE_Calibration_HS_Markups_Full_Calibration ...##")
print("#########################################################################")
print("#########################################################################")
print("#########################################################################")
print("#########################################################################")
closeAllConnections()
